<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:glob="clr-namespace:System.Globalization;assembly=mscorlib"
                    xmlns:se="clr-namespace:StswExpress">

    <Style TargetType="{x:Type se:StswChartLegendItem}">
        <Setter Property="Background" Value="{Binding Title, RelativeSource={RelativeSource Self}, Converter={x:Static se:StswColorConverter.Instance}, ConverterParameter='G B?20%'}"/>

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type se:StswChartLegendItem}">
                    <DockPanel>
                        <!-- box -->
                        <se:StswBorder x:Name="OPT_MainBorder"
                                       Background="{TemplateBinding Background}"
                                       BorderBrush="{Binding BorderBrush, RelativeSource={RelativeSource AncestorType={x:Type se:StswChartLegend}}}"
                                       BorderThickness="{Binding BorderThickness, RelativeSource={RelativeSource AncestorType={x:Type se:StswChartLegend}}}"
                                       CornerClipping="{Binding CornerClipping, RelativeSource={RelativeSource AncestorType={x:Type se:StswChartLegend}}}"
                                       CornerRadius="{Binding CornerRadius, RelativeSource={RelativeSource AncestorType={x:Type se:StswChartLegend}}}"
                                       Height="18" Width="18">
                            <Viewbox x:Name="OPT_Percentage" Visibility="Collapsed">
                                <Border Background="{x:Null}" Margin="{Binding Padding, RelativeSource={RelativeSource AncestorType={x:Type se:StswChartLegend}}}">
                                    <se:StswOutlinedText Fill="{DynamicResource StswText.Static.Foreground}"
                                                         FontWeight="Bold"
                                                         Stroke="{DynamicResource StswBox.Static.Background}"
                                                         StrokeThickness="4"
                                                         Text="{Binding Percentage, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}, StringFormat={}{0:N0}%}"/>
                                </Border>
                            </Viewbox>
                        </se:StswBorder>
                        <!-- name -->
                        <Label Content="{Binding Title, TargetNullValue=—}" VerticalContentAlignment="Center"/>
                        <!-- tooltip -->
                        <DockPanel.ToolTip>
                            <se:StswChartTip ShowDescription="True" ShowName="False"/>
                        </DockPanel.ToolTip>
                    </DockPanel>
                    <!-- triggers -->
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding ShowDetails, RelativeSource={RelativeSource AncestorType={x:Type se:StswChartLegend}}}" Value="True">
                            <Setter Property="Width" Value="36" TargetName="OPT_MainBorder"/>
                            <Setter Property="Visibility" Value="Visible" TargetName="OPT_Percentage"/>
                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
</ResourceDictionary>