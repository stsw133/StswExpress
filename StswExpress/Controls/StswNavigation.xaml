<UserControl x:Class="StswExpress.StswNavigation"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:se="clr-namespace:StswExpress"
             mc:Ignorable="d" d:DesignHeight="200" d:DesignWidth="100">

    <UserControl.Template>
        <ControlTemplate TargetType="{x:Type UserControl}">
            <DockPanel>
                
                <!-- navigation part -->
                <se:ClippingBorder x:Name="PART_MainBorder"
                                   Background="{TemplateBinding Background}"
                                   BorderBrush="{TemplateBinding BorderBrush}"
                                   BorderThickness="0"
                                   CornerRadius="{Binding CornerRadius, RelativeSource={RelativeSource TemplatedParent}}"
                                   SnapsToDevicePixels="True">
                    <DockPanel Loaded="PART_Buttons_Loaded">

                        <!-- special buttons -->
                        <DockPanel x:Name="PART_ButtonsSpecial"
                                   DockPanel.Dock="Top"
                                   HorizontalAlignment="Left">
                            <se:StswToggleButton BorderThickness="0"
                                                 CornerRadius="0"
                                                 IsChecked="{Binding ExtendedMode, RelativeSource={RelativeSource TemplatedParent}}">
                                <se:StswHeader IconData="{x:Static se:StswIcons.Menu}" IconScale="1.5"/>
                            </se:StswToggleButton>
                            <Border x:Name="PART_SeparatorSpecial"
                                    DockPanel.Dock="Top"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{Binding SubBorderThickness, RelativeSource={RelativeSource TemplatedParent}}"
                                    Visibility="{Binding ExtendedMode, RelativeSource={RelativeSource TemplatedParent}, Converter={x:Static se:conv_Bool.Instance}}"/>
                        </DockPanel>
                        <Border x:Name="PART_SeparatorFirst"
                                DockPanel.Dock="Top"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{Binding SubBorderThickness, RelativeSource={RelativeSource TemplatedParent}}"/>

                        <!-- navigation special buttons -->
                        <DockPanel x:Name="PART_ButtonsLast"
                                   DockPanel.Dock="Bottom">
                            <Border x:Name="PART_SeparatorLast"
                                    DockPanel.Dock="Top"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{Binding SubBorderThickness, RelativeSource={RelativeSource TemplatedParent}}"
                                    Visibility="{Binding ButtonsLast.Count, RelativeSource={RelativeSource TemplatedParent}, Converter={x:Static se:conv_Compare.Instance}, ConverterParameter=!0}"/>
                            <ItemsControl ItemsSource="{Binding ButtonsLast, RelativeSource={RelativeSource TemplatedParent}}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="{Binding Orientation, RelativeSource={RelativeSource AncestorType={x:Type se:StswNavigation}}}"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.Resources>
                                    <Style TargetType="{x:Type se:StswNavigationElement}">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ExtendedMode, RelativeSource={RelativeSource AncestorType={x:Type se:StswNavigation}}}" Value="False">
                                                <Setter Property="IsCompact" Value="True"/>
                                                <Setter Property="TextVisibility" Value="Collapsed"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                        <EventSetter Event="Click" Handler="StswNavigationElement_Click"/>
                                    </Style>
                                </ItemsControl.Resources>
                            </ItemsControl>
                        </DockPanel>

                        <!-- navigation buttons -->
                        <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                            <ItemsControl ItemsSource="{Binding Buttons, RelativeSource={RelativeSource TemplatedParent}}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="{Binding Orientation, RelativeSource={RelativeSource AncestorType={x:Type se:StswNavigation}}}"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.Resources>
                                    <Style TargetType="{x:Type se:StswNavigationElement}">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ExtendedMode, RelativeSource={RelativeSource AncestorType={x:Type se:StswNavigation}}}" Value="False">
                                                <Setter Property="IsCompact" Value="True"/>
                                                <Setter Property="TextVisibility" Value="Collapsed"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Orientation, RelativeSource={RelativeSource AncestorType={x:Type se:StswNavigation}}}" Value="Horizontal">
                                                <Setter Property="IsCompact" Value="True"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                        <EventSetter Event="Click" Handler="StswNavigationElement_Click"/>
                                    </Style>
                                </ItemsControl.Resources>
                            </ItemsControl>
                        </ScrollViewer>

                    </DockPanel>
                </se:ClippingBorder>

                <!-- frame separator -->
                <Border x:Name="PART_FrameSeparator"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{Binding SubBorderThickness, RelativeSource={RelativeSource TemplatedParent}}"
                        SnapsToDevicePixels="True"/>

                <!-- frame part -->
                <ContentControl Content="{TemplateBinding Content}"
                                ContentTemplate="{TemplateBinding ContentTemplate}"
                                ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}"
                                Margin="{TemplateBinding Padding}"/>

            </DockPanel>
            <ControlTemplate.Triggers>
                <DataTrigger Binding="{Binding Orientation, RelativeSource={RelativeSource Self}}" Value="Horizontal">
                    <Setter Property="DockPanel.Dock" Value="Top" TargetName="PART_MainBorder" />
                    <Setter Property="DockPanel.Dock" Value="Left" TargetName="PART_ButtonsSpecial" />
                    <Setter Property="Visibility" Value="Collapsed" TargetName="PART_SeparatorSpecial" />
                    <Setter Property="DockPanel.Dock" Value="Left" TargetName="PART_SeparatorFirst" />
                    <Setter Property="DockPanel.Dock" Value="Right" TargetName="PART_ButtonsLast" />
                    <Setter Property="DockPanel.Dock" Value="Left" TargetName="PART_SeparatorLast" />
                    <Setter Property="DockPanel.Dock" Value="Top" TargetName="PART_FrameSeparator" />
                </DataTrigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
    </UserControl.Template>
</UserControl>
